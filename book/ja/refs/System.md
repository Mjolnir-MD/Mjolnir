# System

系に含まれる粒子や、系の境界条件、系全体のパラメータなどを設定します。

複数のシミュレーションボックスを持つシミュレーションのためにテーブルの配列として
定義されていますが、通常のシミュレーションでは一つしか定義しません。

## 例

```toml
[[systems]]
attributes.temperature = 300.0
boundary_shape = {} # Unlimited
particles = [
    {m= 1.0, pos=[ 1.000, 2.000, -1.000], vel=[ 0.100,-0.200, 0.300], name="CA", group="A"},
    # ...
]
```

## 入力

- `boundary_shape`: テーブル型
  - 境界の具体的な大きさを設定します。
- `attributes`: テーブル型
  - 系全体に適用されるパラメータを設定します。
- `particles`: テーブルの配列型
  - 系に含まれる粒子のパラメータと、初期条件を設定します。

### `boundary_shape`

境界の具体的な大きさを設定します。

#### 境界条件が`Unlimited`の場合

境界条件が`"Unlimited"`の場合、このテーブルは空です。

```toml
[[systems]]
boundary_shape = {}
```

#### 境界条件が`PeriodicCuboid`の場合

境界条件が`PeriodicCuboid`の場合、直方体の各座標の最大と最小の座標を取る頂点を設定します。

- `lower`: 浮動小数点の配列型
  - 各座標で最小の座標を取る頂点の位置を指定します。
- `upper`: 浮動小数点の配列型
  - 各座標で最大の座標を取る頂点の位置を指定します。

```toml
boundary_shape = {lower = [0.0, 0.0, 0.0], upper = [10.0, 10.0, 10.0]}
```

### `attribute`

系全体に適用されるパラメータを指定します。
力場やシミュレータによって必要なパラメータが変化します。
現在、要求される変数は以下のどれかです。

- `temperature`: 浮動小数点数型
  - 系の参照温度を指定します。温度一定のシミュレーションを行う際は指定しておく必要があります。
- `ionic_strength`: 浮動小数点数型
  - 系のイオン強度を指定します。単位は[mol/L]です。
  - イオン粒子が陽に含まれない系で静電相互作用を使用する際に必要になることがあります。

### `particles`

系の粒子のパラメータと、初期条件を指定します。
一つの粒子に対して一つのテーブルが割り当てられ、質量、位置、速度、名前、グループ名を指定します。

```toml
particles = [
    {m= 1.0, pos=[ 1.000, 2.000, -1.000], vel=[ 0.100,-0.200, 0.300], name="CA", group="A"},
    # ...
]
```

名前とグループ名は、ASCIIで15文字以下の文字列でなければなりません。

{% hint style='working' %}
version 1.1.0 現在、名前をグループ名のパラメータは出力時にしか考慮されません。
{% endhint %}

## ファイル分割の方法

`[[systems]]`テーブルは、メインの入力ファイルと事なるファイルに分割することが可能です。
以下のようにします。

```toml
# メインの入力ファイル
[files]
input.path = "./input/"

[[systems]]
file_name = "system.toml"
```

`files.input.path`と`file_name`を結合した名前のファイルが読み込まれます。

```toml
# ./input/system.toml
[[systems]]
# ここでは統一感の為にテーブルの配列を使っていますが、個別のファイルには一つしか
# テーブルを書かないので、単なるテーブルでも構いません。
# ...
```


